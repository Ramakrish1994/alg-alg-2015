
\Lecture{Jayalal Sarma}{August, 10 2015}{05}{Orbit Stabilizer Lemma}{Ameya Panse}{Gamma}

In this lecture we will understand and prove the Orbit Stabilizer Lemma, while defining the various terms associated with it.


\begin{definition}(Order of a Group.) Order of a group $G$ is number of elements in the group, that is $|G|$ \end{definition}

\begin{definition}(Right coset) Let $H \le G$ and $g \in G$. The right coset of $H$ in $G$ is defined as 
\begin{center}
$Hg = \{hg \mid h \in H\}$
\end{center}
 \end{definition}

\begin{definition}(Left coset) Let $H \le G$ and $g \in G$. The left cosets of $H$ in $G$ is defined as 
\begin{center}
$gH = \{gh \mid h \in H\}$
\end{center}
\end{definition}

\begin{note}
In general, it is not necessary that the left and right cosets are the same.
\end{note}

\begin{definition}(Normal Subgroup)
Let $H \le G$. We say $H$ is a {\em Normal Subgroup} of $G$ if
\begin{center}
$\forall g \in G, Hg= gH$
\end{center}
\end{definition}

Let H be a Normal SubGroup of G. Divide G into co-sets of H and take one element from each of these as a representative of the set.
\begin{claim} These elements have a group structure among them. \end{claim}
This will be proved in later classes.

\section{Group Action and Orbits}
Let $G$ be a SubGroup of $S_n$. Let $\alpha \in [n]$ and $g \in G$.

\begin{notation} $\alpha^g$ is the image of $\alpha$ under the permutation $g$. 
\end{notation}

Orbit of an element $\alpha$ in $G$ is the set of elements it gets mapped to under permutations in $G$. More formally,

\begin{definition}(Orbit of $\alpha$ in $G$)
The orbit of $\alpha$ in $G$ is defined as
\begin{center}
$\alpha^G = \{\alpha^g \mid g \in G\}$
\end{center}
\end{definition}

Having defined orbits it is natural to partition $G$ into equi



\subsection{An Equivalence Relation}
Consider the following relation,
\[\alpha \backsim \beta \leftrightarrow \exists g \in G, \alpha^g = \beta\]

\begin{claim}
The relation 
\[\alpha \backsim \beta \leftrightarrow \exists g \in G, \alpha^g = \beta\]
is an equivalence relation. 
\end{claim}
\begin{proof}
\textbf{Reflexive:} $e \in G$, where e is the identity element. Hence, $\alpha \backsim \alpha$ \\
\textbf{Symmetric:} Let $\alpha \backsim \beta$. Thus $\exists g \in G, \alpha^g = \beta$. Hence, $\alpha = \beta^{g^{-1}}$. Thus, $\beta \backsim \alpha$ \\
\textbf{Transitive:} Let $\alpha \backsim \beta, \beta \backsim \gamma$. By definition, $\exists g_1, g_2 \alpha^{g_1} = \beta, \beta^{g_2} = \gamma$. By composition of permnutations, $(\alpha^{g_1})^{g_2} = \gamma$. Hence, $\alpha \backsim \gamma$.
\end{proof}

Are there prmutations that map $\alpha$ to $\alpha$ ? i.e. Are there prmutations that stabilize $\alpha$ ?


\begin{definition}(Stabilizer of $\alpha$.)
The stabilizer of $\alpha$ in $G$ is 
\begin{center}
$G_{\alpha} = \{g \mid \alpha^g = \alpha\}$
\end{center}
\end{definition}

\begin{observation}
$G_{\alpha}$ is a Subgroup of $G$.
\end{observation}

\subsection{Orbit-Stabilizer Lemma}
\begin{theorem}
Let $G\leq S_n$. Then for any $\alpha \in [n]$,
\begin{center}
$|\alpha^G|*|G_{\alpha}| = |G|$ 
\end{center}
\end{theorem}
\begin{proof}
Since $G_{\alpha}$ forms a Subgroup of $G$, by Lagrange's Theorem,
\begin{center}
$\frac{|G|}{|G_{\alpha}|} = \mbox{number of distinct right cosets of $G_\alpha$ in $G$}$. 
\end{center}
In Lemma \ref{bijection} we show that There exists a bijection from $\alpha^G$ to cosets of $G_{\alpha}$ in $G$. Therefore, number of distinct right cosets of $G_{\alpha}$ = $|\alpha^G|$. 
\end{proof}


\begin{lemma}
\label{bijection}
There exists a bijection $\eta$ from $\alpha^G$ to cosets of $G_{\alpha}$ in $G$.
\end{lemma}
\begin{proof}
The idea is that the set of permutations that send $\alpha$ to $\beta$, form a coset of permutations that send $\alpha$ to $\alpha$.

Let $\beta \in \alpha^G$ and $h \in G,\alpha^h = \beta$. Consider the map
$\eta : \beta \rightarrow \{g \in G| \alpha^g = \beta \} $. We need to show that  $\{g \in G| \alpha^g = \beta \} $ is a right coset of $G_\alpha$ in $G$.
\begin{align*}
\{g \in G\mid \beta = \alpha^g\} &= \{ g \in G \mid \alpha^h = \alpha^g \}\\
 &=  \{ g \in G \mid \alpha^{gh^{-1}} = \alpha\}
\end{align*}
Thus $gh^{-1} \in G_{\alpha}$.
\begin{align*}
\{g \in G\mid \beta = \alpha^g\}  &= \{ g \in G \mid gh_{-1} \in G_{\alpha} \}\\
 &=  \{ g \in G \mid g \in G_{\alpha}h \}
\end{align*}
Observe that $\eta$ is well defined.

\begin{exercise}
Complete the above proof by showing that $\eta$ is both injective and surjective .
\end{exercise}
\end{proof}




\section{Graph Automorphism and Graph Isomorphism}
We will now define and analyse various problems related to GI.\\

\fbox{
\begin{minipage}{10 cm}\textbf{PROBLEM : GRAPH ISOMORPHISM [GI]}\\
\textbf{Input} : A graph $X_1=(V_1,E_1)$ and $X_2=(V_2,E_2)$\\
\textbf{Output} : Decide if $X_1\cong X_2$ or not.
\end{minipage}
}
\vspace{3mm}

\fbox{
\begin{minipage}{10 cm}\textbf{PROBLEM : GRAPH AUTOMORPHISM [GA]}\\
\textbf{Input} : A graph $X=(V,E)$\\
\textbf{Output} : A Generating Set for $Aut(X)$.
\end{minipage}
}

\vspace{3mm}

\fbox{
\begin{minipage}{10 cm}\textbf{PROBLEM : GRAPH RIGIDITY [GR]}\\
\textbf{Input} : A graph $X=(V,E)$\\
\textbf{Output} : Decide if $Aut(X)$ is trivial or not.
\end{minipage}
}

\vspace{3mm}

\fbox{
\begin{minipage}{10 cm}\textbf{PROBLEM : NUMBER OF ISOMORPHISMS [\# GI]}\\
\textbf{Input} : A graph $X_1=(V_1,E_1),X_2=(V_2,E_2)$\\
\textbf{Output} : The number of Isomorphisms from $X_1$ to $X_2$.
\end{minipage}
}

\vspace{3mm}

\fbox{
\begin{minipage}{10 cm}\textbf{PROBLEM : NUMBER OF AUTOMORPHISMS [\# GA]}\\
\textbf{Input} : A graph $X=(V,E)$\\
\textbf{Output} : $|Aut(X)|$.
\end{minipage}
}

\vspace{3mm}

\fbox{
\begin{minipage}{10 cm}\textbf{PROBLEM : COMPUTING ISOMORPHISM [ISO]}\\
\textbf{Input} : A graph $X_1=(V_1,E_1),X_2=(V_2,E_2)$\\
\textbf{Output} : An adjacency preserving bijection from $V_1$ to $V_2$.
\end{minipage}
}

\vspace{3mm}

\fbox{
\begin{minipage}{10 cm}\textbf{PROBLEM : COMPUTING AUTOMORPHISM [AUT]}\\
\textbf{Input} : A graph $X=(V,E)$\\
\textbf{Output} : A non-trivial element of $Aut(X)$.
\end{minipage}
}

\section{Informal notion of Reductions} 
Given two problems $A,B$, we say that $A \le B$ (A reduces to B), if given a polytime algorithm for B, we can give out a polytimeytime algorithm for A.

In the next lecture we will talk about the relation among the above defined problems.



\Lecture{Jayalal Sarma}{August, 11 2015}{06}{A Closer Look at Graph
Isomorphism and Automorphism}{Ameya Panse}{Gamma}

\section{Another related Problem}
Let $X=(V,E)$ be a graph. Consider the vertex set 
$V$ to be divided into $c$ color classes. That is there exists a function $\Psi : V(X) \rightarrow [c]$,
where $i \in [c]$ denotes a color and the $i^{th}$ color class is $\Psi^{-1}(i)$.

We say a graph $X=(V,E)$ is {\em $C$-colored} if
the vertex set $V$ is partitioned into $C$ color classes.

Consider the colored version of GI,

\textbf{Colored Graph Isomorphism [CGI]:} Given two $C$-colored Graphs $(X_1,\Psi_1)$ and $(X_2,\Psi_2)$
decide if there exists $\sigma : V(X_1) \rightarrow V(X_2)$ such that for all
$(u,v) \in V(X_1)\times V(X_2)$,  $(u,v) \in E(X_1)$ if and only if $(\sigma(u), \sigma(v)) \in E(X_2) $
 and for every $u \in V(X_1),\Psi_1(u) = \Psi_2(\sigma(u))$ .

\section{Relationships Among the Problems}


\subsection{GI $\le$ CGI}
GI trivially reduces to CGI.	Set $c=1$, and color all the vertices with the same color.


\subsection{CGI $\le$ GI}
Given $(X_1,\Psi_1)$ and $(X_2,\Psi_2)$ construct graphs $X_1'$ and $X_2'$ such that 
\[ ((X_1,\Psi_1),(X_2,\Psi_2))\in CGI \iff (X_1',X_2')\in GI \]
The construction of $X_1'$ and $X_2'$ are as follows :
For every vertex $u \in V(X_1)$ such that $u \in \Psi_1^{-1}(i)$:
\begin{enumerate}
\item Add $ni$ extra vertices to $X_1$.
\item Add edges from each of the extra vertices to $u$.
\end{enumerate}
Do the same for $(X_2,\Psi_2)$ to get $X_2'$.\\

\begin{claim}
$((X_1,\Psi_1),(X_2,\Psi_2))\in CGI \iff (X_1',X_2')\in GI$
\end{claim}
\begin{proof}
($\Rightarrow$)Let $(X_1,\Psi_1)$ and $(X_2,\Psi_2)$ $\in CGI$. To show that $X_1' \cong X_2'$. Since  $(X_1,\Psi_1)$ and $(X_2,\Psi_2)$ $\in CGI$ we know that there exists $\sigma : V(X_1) \rightarrow V(X_2)$ such that $\forall (u,v) \in V(X_1)\times V(X_2), (u,v) \in E(X_1)$ if and only if $(\sigma(u), \sigma(v)) \in E(X_2) $ and $\forall u \in V(X_1) , \Psi_1(u) = \Psi_2(\sigma(u))$. Additionally map the extra vertices added correspondingly. Thus $X_1' \cong X_2'$.\\
($\Leftarrow$)Let $X_1' \cong X_2'$. To show that $(X_1,\Psi_1) \cong (X_2,\Psi_2)$.\\
$X_1' \cong X_2'$, hence $ \exists \sigma : V(X_1') \rightarrow V(X_2'), \forall (u,v) \in E(X_1'), (\sigma(u),\sigma(v)) \in E(X_2')$.\\
If possible let there exist $ u \in v(X_1), u \in \Psi^{-1}(i)$ such that $\sigma(u) \notin V(X_2)$. That is, u is mapped to one of the extra vertices. But $u \in X_1'$ and $deg(u) \ge ni$, whereas degree of any extra vertex is 1. Hence, we have a contradiction.

Now, if possible let $u \notin \Psi_2^{-1}(i)$. Hence $\sigma(u) \in \Psi_2^{-1}(j)$ and $j \neq i$. Note that $ni + n$ \textgreater $deg(u) \ge ni \implies n(i+1)$ \textgreater $deg(u) \ge ni$.

And, $\sigma(u) \in \Psi_2^{-1}(j) \implies n(j+1)$ \textgreater $deg(u) \ge nj$. Since both of these can not be true simultaneously, we have a contradiction.

Hence, $\sigma(u) \in V(X_2) , \sigma(u) \in \Psi_2^{-1}(i)$. Thus, $(X_1,\Psi_1) \cong (X_2,\Psi_2)$.

We have made only one query to GI. Hence, the reduction is polytime.
\end{proof}



\subsection{Computing Isomorphism $\le GI$}
We show that computing isomorphism reduces to colored graph isomorphism. As $CGI\leq GI$ we have $Computing Isomorphism \le GI$.  Given $X_1,X_2$ Output a permutation that maps $X_1$ to $x_2$.
The Reduction is as follows:
\begin{enumerate}
\item Check if $X_1 \cong X_2$. If NO, end.
\item For each vertex $i \in V_1$ 
	Color $i$ with color $C_i$.
	\begin{itemize}
	\item Color $j \in V_2$ that is not already colored with $C_i$, temporarily.
	\item Query CGI to check if $X_1\cong X_2$.
	\item Repeat on $j$ untill you get a "yes" answer. Fix color of $j$ as $C_i$.
	\end{itemize}
Ouput the permutation.
\end{enumerate}
Here each vertex is colored with a different color, and hence we have a permutation.\\
Also, if the graphs are isomorphic, then there will exists an $j \in V_2$, such that we get a yes answer.

Observe that we make atmost $O(n^2)$ queries to $CGI$ which in turn makes a single query to $GI$. Thus the reduction is polytime.


\subsection{GI $\le$ GA}
Take $X = X_1 \cup X_2$. We need to construct a graph $G$ such that the generating set $S$ of $Aut(G)$ enables to decide if $X_1\equiv X_2$.

\begin{claim}
$X_1 \cong X_2$ if and only if there exists a $\sigma \in S$ such that $\sigma$ maps atleast one vertex in $X_1$ to a vertex in $X_2$.
\end{claim}

\begin{proof}
\textbf{Case 1 : $X_1$ and $X_2$ are connected.}

($\Rightarrow$) Suppose $X_1 \cong X_2$. Then there exists a $\tau$ which is an isomorphism from $X_1,$ to $X_2$. $\tau \in Aut(X)$. Hence, there is a $\sigma$ that maps a vertex in $X_1$ to a vertex in $X_2$.\\

($\Leftarrow$) Let there exist a $\sigma\in S$ such that $\sigma$ maps $u \in X_1$ to a vertex in $X_2$. Let $v \in X_1$ be such that $\sigma(u) \in X_1$. Since $X_1$ is connected $u,v$ are connected. But $\sigma(u) \in X_2, \sigma(v) \in X_1$ are not connected which is a contradiction. Therefore for $\sigma\in S$, $\sigma$ maps all the vertices in $X_1$ to $X_2$. Thus $X_1 \cong X_2$.

\textbf{Case 2 : $X_1$ and $X_2$ are not connected.}

In case the two are not connected, add an extra vertex to both the graphs that is adjacent to all the vertices in the corresponding graphs. Since, the new vertices have degree $n$, they can only be mapped to each other.
\end{proof}

Thus GI $\le$ GA.



