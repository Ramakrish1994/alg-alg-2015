\Lecture{Jayalal Sarma}{August, 10 2015}{05}{Orbit Stabilizer Lemma}{Ameya Panse}


\section*{â€¢}
In this lecture we will understand and prove the Orbit Stabilizer Lemma, while defining the various terms associated with it.


\begin{definition}(Order of a Group.) Order of a group $G$ is number of elements in the group denoted by $|G|$ .
\end{definition}

\begin{definition}(Right coset.) Let $H \le G$ and $g \in G$. The right coset of $H$ in $G$ is defined as 
\begin{center}
$Hg = \{hg \mid h \in H\}$
\end{center}
\end{definition}

\begin{definition}(Left coset.) Let $H \le G$ and $g \in G$. The right coset of $H$ in $G$ is defined as 
\begin{center}
$gH = \{gh \mid h \in H\}$
\end{center}
\end{definition}

\begin{note}
In general, it is not necessary that the left and right cosets are the same.
\end{note}

\begin{definition}(Normal Subgroup.)
Let $H \le G$. $H$ is called a \em Normal Subgroup if it satisfies the following condition.
\begin{center}
$\forall g \in G, Hg= gH$
\end{center}
\end{definition}

Let $H$ be a Normal subgroup of $G$. Divide $G$ into cosets of $H$ and take one element from each of these as a representative of the set.
\begin{claim} These elements have a group structure among them. \end{claim}
This will be proved in later classes.

\section{Group Action and Orbits}
Let $G$ be a subgroup of $S_n$. Let $\alpha \in [n]$ and $g \in G$.

\begin{notation}We denote by $\alpha^g$ the image of $\alpha$ under the permutation $g\in G$. \end{notation}

\begin{definition}(Orbit.) Let $\alpha \in [n]$ and $g \in G$. We define the {\em orbit of $\alpha$} as
\begin{center}
$\alpha^G = \{\alpha^g \mid g \in G\}$
\end{center}
\end{definition}

\subsection{An Equivalence Realtion}

\begin{lemma}
The relation 
\[\alpha \backsim \beta \iff \exists g~ g\in G, \alpha^g = \beta\]
is an equivalence relation.
\end{lemma}
\begin{proof}
\textbf{Reflexive: } $e \in G$, where $e$ is the identity element. Hence, $\alpha \backsim \alpha$ \\
\textbf{Symmetric: } Let $\alpha \backsim \beta$. Then by definition, $\exists g\in G, \alpha^g = \beta$. Hence, $\alpha = \beta^{g^{-1}}$. Thus, $\beta \backsim \alpha$ \\
\textbf{Transitive: } Let $\alpha \backsim \beta, \beta \backsim \gamma$. By definition, $\exists g_1,g_2\in G$ such that $\alpha^{g_1} = \beta$ and  $\beta^{g_2} = \gamma$. By composition of permutations, $(\alpha^{g_1})^{g_2} = \gamma$. Hence, $\alpha \backsim \gamma$.
\end{proof}

Having defined orbits we noe look at permutations that fix elemets.


\begin{definition}(Stabilizer of $\alpha$.)
Let $G\leq S_n$, $\alpha \in [n]$ and $g \in G$. WE define the stabilizer of $\alpha$ to be the set
\begin{center}
$G_{\alpha} = \{g \mid \alpha^g = \alpha\}$
\end{center}
\end{definition}

The set $G_\alpha$ is a subset of $G$. It is natural to ask if it is something more than just a sibset of $G$.
Does it have a group structure ? 

\begin{observation}
$G_{\alpha}$ is a subgroup of $G$.
\end{observation}

\subsection{Orbit Stabilizer Lemma}





\[\forall \alpha \in [n] |\alpha^G|*|G_{\alpha}| = |G| \]
\begin{claim}
There exists a bijection from $\alpha^G$ to cosets of $G_{\alpha}$ in G.
\end{claim}
\begin{corollary}
Number of cosets of $G_{\alpha}$ = $\|\alpha^G\|$.
\end{corollary}
As $G_{\alpha}$ forms a subgroup, applying Lagrange's Theorem, we get the Orbit Stabilizer Lemma.

\textbf{Proof of Claim:}
The idea is that the set of permnutations that send $\alpha$ to $\beta$, form a Co-set of permutations that send $\alpha$ to $\alpha$.
\\
Let $\beta \in \alpha^G$ and $h \in G,\alpha^h = \beta$.\\
\begin{align*}
\text{Consider} & \{g \in G| \beta = \alpha^g\}
\text{  We have to show that this is a Co-set}\\
 = & \{ g \in G | \alpha^h = \alpha^g \}\\
 = & \{ g \in G | \alpha^{gh^{-1}} = \alpha\}\\
\text{Thus } &  gh^{-1} \in G_{\alpha}\\
 = & \{ g \in G | gh_{-1} \in G_{\alpha} \}\\
 = & \{ g \in G | g \in G_{\alpha}h \}\\
\end{align*}

\begin{exercise}
 Complete the above proof by showing a bijection between $\beta$'s and the Co-sets of $G_{\alpha}$.
\end{exercise}

\section{Graph Automorphism and Graph Isomorphism}
We will now define and analyse various problems related to GI.\\
\textbf{Graph Isomorphism [GI]: } Given graphs $G_1, G_2$,\\
\text{Output}  1 \\ \text{if} \exists \sigma : V_1 \rightarrow V_2, \forall (u,v) \in E_1, (\sigma(u),\sigma(v)) \in V_2\\
 \text{else Output}  0.\\  

\begin{definition}[Automorphism]
A Graph G is said to be automorphic if it is non-trivially isomorphic to itself.
\end{definition}

\begin{definition}[$Aut(G)$]
\[Aut(G) = \{\sigma \in S_n | G \cong \sigma(G)\}\]
\end{definition}

\textbf{Graph Automorphism [GA] :} Given $G$, output a Generating Set for $Aut(G)$.\\

\textbf{Graph Rigidity [GR] :} Given $G$, test if $Aut(G)$ is non-trivial.\\

\textbf{Number of Isomorphisms [\#GI] :} Given $G_1,G_2$, output the number of Isomorphisms from $G_1$ to $G_2$.\\

\textbf{Number of Automorphisms [\#GA] :} Given $G$, output the size of $Aut(G)$.\\

\textbf{Computing Isomorphism} Given $G_1,G_2$, output the permutation that morphs $G_1$ to $G_2$.\\

\textbf{Computing Automorphism} Given $G$, output a non-trivial element in $Aut(G)$.\\

\section{Informal Reduction} 
Given two problems $A,B$, we say that $A \le B$ (A reduces to B), if given a polytime algorithm for B, we can give out a polytimeytime algorithm for A.\\ 


In the next lecture we will talk about the relation among the above defined problems.



\Lecture{Jayalal Sarma}{August, 11 2015}{06}{A Closer Look at Graph Isomorphism and Automorphism}{Ameya Panse}

\section{Another related Problem}
Here the vertex set is divided into $c$ color classes by the function 
\begin{center} $\Psi : V(X) \rightarrow [c]$,\\
 where $i \in [c]$ denotes a color and\\
 the $i^{th}$ color class is $\Psi^{-1}(i)$.\end{center}\\

\textbf{Colored Graph Isomorphism [CGI]:} Given two $C$-colored Graphs $(X_1,\Psi_1)$ and $(X_2,\Psi_2)$\\
Output $1$ \\
if $\exists \sigma : V(X_1) \rightarrow V(X_2)$ such that 
$\forall (u,v) \in V(X_1)\timesV(X_2), (u,v) \in E(X_1)$ if and only if $(\sigma(u), \sigma(v)) \in E(X_2) $\\
 and $\forall u \in V(X_1) , \Psi_1(u) = \Psi_2(\sigma(u))$ .

\section{Relations Among the Problems}

\subsection{$GI \le CGI$}
	Set $c=1$, and color all the vertices with the same color.

\subsection{$CGI \le GI$}
Given $(X_1,\Psi_1)$ and $(X_2,\Psi_2)$.\\
\textbf[Gadget] : $\forall u \in V(X_1)$ such that $u \in \Psi_1^{-1}(i)$:
\begin{enumerate}
\item Add $ni$ extra vertices to $X_1$.
\item Add edges from each of the extra vertices to u to get the graph $X_1'$.
\end{enumerate}
Do the same for $(X_2,\Psi_2)$ to get $X_2'$.\\
Now run $GI$ on $X_1',X_2'$.\\

\textbf{Correctness :}

Let $(X_1,\Psi_1)$ and $(X_2,\Psi_2)$ $\in CGI$. Hence $\exists \sigma : V(X_1) \rightarrow V(X_2)$ such that 
$\forall (u,v) \in V(X_1)\times V(X_2), (u,v) \in E(X_1)$ if and only if $(\sigma(u), \sigma(v)) \in E(X_2) $\\
 and $\forall u \in V(X_1) , \Psi_1(u) = \Psi_2(\sigma(u))$. Additionally map the extra vertices added correspondingly. Thus $X_1' \cong X_2'$.
\\

Let $X_1' \cong X_2'$, hence $ \exists \sigma : V(X_1') \rightarrow V(X_2'), \forall (u,v) \in E(X_1'), (\sigma(u),\sigma(v)) \in E(X_2')$.\\
If possible let there exist $ u \in v(X_1), u \in \Psi^{-1}(i)$ such that $\sigma(u) \notin V(X_2)$. That is, u is mapped to one of the extra vertices. But $u \in X_1'$ and $deg(u) \ge ni$, whereas degree of any extra vertex is 1. Hence, we have a contradiction.\\

Now, if possible let $u \notin \Psi_2^{-1}(i)$. Hence $\sigma(u) \in \Psi_2^{-1}(j)$ and $j \neq i$.
Note that $ni + n \textgreater deg(u) \ge ni \implies n(i+1) \textgreater deg(u) \ge ni$.
And, $\sigma(u) \in \Psi_2^{-1}(j) \implies n(j+1) \textgreater deg(u) \ge nj$. Since both of these can not be true simultaneously, we have a contradiction.\\

Hence, $\sigma(u) \in V(X_2) , \sigma(u) \in \Psi_2^{-1}(i)$. Thus, $(X_1,\Psi_1) \cong (X_2,\Psi_2)$.\\

\textbf{Time Complexity :} We have made only one query to GI. Hence, the reduction is polytime.\\

\textbf{Hence Proved.}

\subsection{Computing Isomorphism \le GI}
Given $X_1,X_2$ Output a permutation that morphs $X_1$ to $x_2$.
The Reduction is as follows:
\begin{enumerate}
\item Check if $X_1 \cong X_2$. If NO, end.
\item For each vertex $i \in V_1$ 
	Color $i$ with color $C_i$.
	\begin{itemize}
	\item Color $j \in V_2 -$ [Already Colored Vertices] with $C_i$, temporarily.
	\item Query to CGI.
	\item Repeat on $j$ untill you get a yes answer. Fix color of $j$ as $C_i$.
	\end{itemize}
Ouput the permutation.
\end{enumerate}
Here each vertex is colored with a different color, and hence we have a permutation.\\
Also, if the graphs are isomorphic, then there will exists an $j \in V_2$, such that we get a yes answer.\\

\textbf{Time Complexity:} We make atmost $O(n^2)$ queries to $CGI$ which in turn makes a single query to $GI$.\\Thus the reduction is polytime.




\subsection{$GI \le GA$}
Take $X = X_1 \cup X_2$.\\
Let S be the generating set of $Aut(G)$..\\
\begin{claim}
$X_1 \cong X_2$ if and only if $\exists \sigma \in S$ such that $\sigma$ maps atleast one vertex in $X_1$ to a vertex in $X_2$.
\end{claim}

For the time being assume that the two graphs are connected graphs.\\
\textbf{Forward Direction} Assume that $X_1 \cong X_2$.\\
	$\exists \tau$ which is an isomorphism between $X_1,X_2$. $\tau \in Aut(X)$. Hence, there is a $\sigma$ that maps a vertex in $X_1$ to a vertex in $X_2$.\\
\textbf{Backward Direction :} $\exists \sigma$ that maps $u \in X_1$ to $\sigma(u) \in X_2$. Let $v \in X_1$ be such that $\sigma(u) \in X_1$. Since $X_1$ is connected $u,v$ are connected. But $\sigma(u) \in X_2, \sigma(v) \in X_1$ are not connected. Hence, we have a contradiction. Thus, $\sigma$ maps all vertices in $X_1$ to $X_2$. Thus $X_1 \cong X_2$.\\

In case the two are not connected, add an extra vertex to both the graphs that is adjeacent to all the vertices in the correcponding graphs. Since, the new vertices hace degree n, they can be mapped only to each other.\\
\textbf{Hence Proved.}

